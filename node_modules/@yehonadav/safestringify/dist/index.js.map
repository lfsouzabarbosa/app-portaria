{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["const _replacer = (cache:Array<any>|null) => (_key: string, value: any) =>\r\n  typeof value === \"object\" && value !== null\r\n    // @ts-ignore\r\n    ? cache.includes(value)\r\n    ? undefined // Duplicate reference found, discard key\r\n    // @ts-ignore\r\n    : cache.push(value) && value // Store value in our collection\r\n    : value;\r\n\r\n// safely handles circular references\r\nexport const replacerFactory = () => {\r\n  const cache:Array<any>|null = [];\r\n  return _replacer(cache);\r\n}\r\n\r\nexport const objectifyError = (e:Error|any) => {\r\n  const error: any = {};\r\n\r\n  Object.getOwnPropertyNames(e).forEach((propName) => {\r\n    error[propName] = e[propName];\r\n  });\r\n\r\n  return error;\r\n}\r\n\r\nexport const errorReplacerFactory = () => {\r\n  const cache:Array<any>|null = [];\r\n\r\n  return (_key: any, value: any) => {\r\n    if (value instanceof Error) {\r\n      return objectifyError(value);\r\n    }\r\n    return _replacer(cache)(_key, value);\r\n  }\r\n}\r\n\r\nconst withStringify = (call:(obj:any, ...args:any[])=>string) => {\r\n  return (obj:any, indent?: string | number) => {\r\n    try {\r\n      return call(obj, indent);\r\n    } catch (e) {\r\n      return obj.toString()\r\n    }\r\n  }\r\n}\r\n\r\nexport const stringify = withStringify((obj):string => {\r\n  return JSON.stringify(\r\n    obj,\r\n    replacerFactory(),\r\n  );\r\n});\r\n\r\nexport const safeStringify = withStringify((obj:any, indent = 2):string => {\r\n  return JSON.stringify(\r\n    obj,\r\n    replacerFactory(),\r\n    indent\r\n  );\r\n});\r\n\r\nexport const stringifyError = withStringify((obj, indent):string => {\r\n  return JSON.stringify(\r\n    obj,\r\n    errorReplacerFactory(),\r\n    indent\r\n  );\r\n});\r\n"],"names":[],"mappings":";;AAAA,IAAM,SAAS,GAAG,UAAC,KAAqB,IAAK,OAAA,UAAC,IAAY,EAAE,KAAU;IACpE,OAAA,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,IAAI;;UAEvC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;cACrB,SAAS;;cAET,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK;UAC1B,KAAK;AANT,CAMS,GAAA,CAAC;AAEZ;IACa,eAAe,GAAG;IAC7B,IAAM,KAAK,GAAmB,EAAE,CAAC;IACjC,OAAO,SAAS,CAAC,KAAK,CAAC,CAAC;AAC1B,EAAC;IAEY,cAAc,GAAG,UAAC,CAAW;IACxC,IAAM,KAAK,GAAQ,EAAE,CAAC;IAEtB,MAAM,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,UAAC,QAAQ;QAC7C,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC;KAC/B,CAAC,CAAC;IAEH,OAAO,KAAK,CAAC;AACf,EAAC;IAEY,oBAAoB,GAAG;IAClC,IAAM,KAAK,GAAmB,EAAE,CAAC;IAEjC,OAAO,UAAC,IAAS,EAAE,KAAU;QAC3B,IAAI,KAAK,YAAY,KAAK,EAAE;YAC1B,OAAO,cAAc,CAAC,KAAK,CAAC,CAAC;SAC9B;QACD,OAAO,SAAS,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;KACtC,CAAA;AACH,EAAC;AAED,IAAM,aAAa,GAAG,UAAC,IAAqC;IAC1D,OAAO,UAAC,GAAO,EAAE,MAAwB;QACvC,IAAI;YACF,OAAO,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;SAC1B;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,GAAG,CAAC,QAAQ,EAAE,CAAA;SACtB;KACF,CAAA;AACH,CAAC,CAAA;IAEY,SAAS,GAAG,aAAa,CAAC,UAAC,GAAG;IACzC,OAAO,IAAI,CAAC,SAAS,CACnB,GAAG,EACH,eAAe,EAAE,CAClB,CAAC;AACJ,CAAC,EAAE;IAEU,aAAa,GAAG,aAAa,CAAC,UAAC,GAAO,EAAE,MAAU;IAAV,uBAAA,EAAA,UAAU;IAC7D,OAAO,IAAI,CAAC,SAAS,CACnB,GAAG,EACH,eAAe,EAAE,EACjB,MAAM,CACP,CAAC;AACJ,CAAC,EAAE;IAEU,cAAc,GAAG,aAAa,CAAC,UAAC,GAAG,EAAE,MAAM;IACtD,OAAO,IAAI,CAAC,SAAS,CACnB,GAAG,EACH,oBAAoB,EAAE,EACtB,MAAM,CACP,CAAC;AACJ,CAAC;;;;;;;;;"}